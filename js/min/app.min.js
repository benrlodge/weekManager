(function(){var t,e,o,r={}.hasOwnProperty,n=function(t,e){function o(){this.constructor=t}for(var n in e)r.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};e=!0,o=function(t){return e?console.log(t):void 0},t=function(t,e){return setTimeout(e,t)},$(function(){var e,r,s,a,i,c,p,u,l,h,d;return r={enter:13,esc:27},e={Mon:".mon",mon:".mon",monday:".mon",Tue:"tue",tue:".tue",Wed:".wed",wed:".wed",Thur:".thur",thur:".thur",Fri:".fri",fri:".fri",today:".today",td:".today",tomorrow:".tomorrow",tom:".tomorrow",od:".onDeck",onDeck:".onDeck",ondeck:".onDeck",backburner:".backburner",bb:".backburner"},s=function(t){function e(){return l=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.defaults={target:".backBurner",detail:"empty",complete:!1},e.prototype.initialize=function(){return this.on("remove",this.destroy)},e}(Backbone.Model),c=new s,a=function(t){function e(){return h=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.url="/",e.prototype.model=s,e.prototype.localStorage=new Store("backbone-tasks"),e.prototype.removeTask=function(t,e){return this.remove(t,e)},e}(Backbone.Collection),p=new a,i=function(s){function i(){return d=i.__super__.constructor.apply(this,arguments)}return n(i,s),i.prototype.el=$("body"),i.prototype.clickStatus=!1,i.prototype.lastDeletedTask="",i.prototype.taskInputWrapper=".newTask",i.prototype.taskInput="#newTaskInput",i.prototype.onDeck=".onDeck",i.prototype.onDeckList=".onDeck ul",i.prototype.today="",i.prototype.initialize=function(){return o("Init View"),this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this),this.fetchStoredCollections()},i.prototype.events=function(){return{keypress:"searchKeyPress",keyup:"searchKeyUp","click .delete":"deleteTask","click a[data-action=undo]":"undoTask"}},i.prototype.template_week=Handlebars.compile($("#template_week").html()),i.prototype.template_sidebar=Handlebars.compile($("#template_sidebar").html()),i.prototype.fetchStoredCollections=function(){var t,e;return e=this,t=this.collection.fetch(),t.done(function(){_.each(e.collection.models,function(){},e)})},i.prototype.render=function(){var t,e,o,r,n,s,i,c,p,u,l,h,d,k;return i=this.collection.where({target:".onDeck"}),t=this.collection.where({target:".backburner"}),n=this.collection.where({target:".mon"}),l=this.collection.where({target:".tue"}),d=this.collection.where({target:".wed"}),p=this.collection.where({target:".thur"}),o=this.collection.where({target:".fri"}),c=new a(i),e=new a(t),s=new a(n),h=new a(l),k=new a(d),u=new a(p),r=new a(o),$("#sidebar").html(this.template_sidebar({onDeckTasks:c.toJSON(),backBurnerTasks:e.toJSON()})),$(".week").html(this.template_week({allTasks:this.collection.toJSON(),monTasks:s.toJSON(),tueTasks:h.toJSON(),wedTasks:k.toJSON(),thurTasks:u.toJSON(),friTasks:r.toJSON()}))},i.prototype.deleteTask=function(t){var e,o;return e=$(t.currentTarget),o=$(e).data("id"),this.undoShow(o),this.lastDeletedTask=this.collection.get(o),p.removeTask(o)},i.prototype.undoTask=function(){return p.create(this.lastDeletedTask),this.messageClear()},i.prototype.messageClear=function(){return $(".messages").empty()},i.prototype.messageUpdate=function(e){var o,r=this;return o="<a href='#' data-id='"+e.id+"' data-action='"+e.action+"'>"+e.message+"</a>",$(".messages").empty().append(o).addClass("show"),t(5e3,function(){return r.messageClear()})},i.prototype.undoShow=function(t){var e;return e={id:t,message:"Undo",action:"undo"},this.messageUpdate(e)},i.prototype.searchHide=function(){return this.searchStatus=!1,$(this.taskInputWrapper).hide(),$(this.taskInput).val(""),this.clickStatus=!1},i.prototype.searchShow=function(){return this.searchStatus=!0,$(this.taskInputWrapper).show(),$(this.taskInput).focus(),this.clickStatus=!0},i.prototype.searchKeyPress=function(t){return t.keyCode===r.enter?this.searchComplete():this.searchShow()},i.prototype.searchKeyUp=function(t){return t.keyCode===r.esc&&this.searchStatus?this.searchHide():void 0},i.prototype.searchComplete=function(){var t;return c=$(this.taskInput).val().trim(),t=this.searchDirectives(c),this.addTask(t),this.searchHide()},i.prototype.searchDirectives=function(t){var o,r,n,s,a,i,c;r=t,a=t.split(":"),s=a[0],n=a[1],c=0;for(o in e)if(i=e[o],o===s)return c++,{directive:i,detail:n};return 0===c?{directive:".backburner",detail:t}:void 0},i.prototype.addTask=function(t){var e,o;return o=t.directive,e=t.detail,p.create({target:t.directive,detail:t.detail})},i}(Backbone.View),u=new i({collection:p})})}).call(this);