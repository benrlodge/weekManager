(function(){var t,e,r,o={}.hasOwnProperty,n=function(t,e){function r(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};e=!0,r=function(t){return e?console.log(t):void 0},window.clearLocal=function(){return localStorage.clear()},t=function(t,e){return setTimeout(e,t)},$(function(){var e,r,o,a,i,s,c,u,p,l,d,h,y;return r={enter:13,esc:27},e={Mon:"#day-mon",mon:"#day-mon",monday:"#day-mon",Tue:"#day-tue",tue:"#day-tue",Wed:"#day-wed",wed:"#day-wed",Thur:"#day-thur",thur:"#day-thur",Fri:"#day-fri",fri:"#day-fri",od:"#onDeck",onDeck:"#onDeck",ondeck:"#onDeck",backburner:"#backburner",bb:"#backburner"},a=function(t){function e(){return l=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.defaults={target:"#backBurner",detail:"empty",order:"",complete:!1},e.prototype.initialize=function(){return this.on("remove",this.destroy)},e}(Backbone.Model),i=function(t){function e(){return d=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.url="/",e.prototype.model=a,e.prototype.localStorage=new Store("backbone-tasks"),e.prototype.removeTask=function(t,e){return this.remove(t,e)},e}(Backbone.Collection),u=new i,s=function(o){function a(){return h=a.__super__.constructor.apply(this,arguments)}return n(a,o),a.prototype.el=$("body"),a.prototype.clickStatus=!1,a.prototype.lastDeletedTask="",a.prototype.taskInputWrapper=".newTask",a.prototype.taskInput="#newTaskInput",a.prototype.onDeck="#onDeck",a.prototype.onDeckList="#onDeck ul",a.prototype.today="",a.prototype.initialize=function(){return this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this),this.fetchStoredCollections(),this.virginCheck(),this.sortablize()},a.prototype.events=function(){return{keypress:"searchKeyPress",keyup:"searchKeyUp","click .delete":"deleteTask","click a[data-action=undo]":"undoTask"}},a.prototype.template_week=Handlebars.compile($("#template_week").html()),a.prototype.template_sidebar=Handlebars.compile($("#template_sidebar").html()),a.prototype.render=function(){var t,e,r,o,n,a,s,c,u,p,l,d,h,y;return s=this.collection.where({target:"#onDeck"}),t=this.collection.where({target:"#backburner"}),n=this.collection.where({target:"#day-mon"}),l=this.collection.where({target:"#day-tue"}),h=this.collection.where({target:"#day-wed"}),u=this.collection.where({target:"#day-thur"}),r=this.collection.where({target:"#day-fri"}),c=new i(s),e=new i(t),a=new i(n),d=new i(l),y=new i(h),p=new i(u),o=new i(r),$("#sidebar").html(this.template_sidebar({onDeckTasks:c.toJSON(),backBurnerTasks:e.toJSON()})),$(".week").html(this.template_week({monTasks:a.toJSON(),tueTasks:d.toJSON(),wedTasks:y.toJSON(),thurTasks:p.toJSON(),friTasks:o.toJSON()})),this.sortablize()},a.prototype.deleteTask=function(t){var e;return e=$(t.currentTarget).closest("li").data("id"),this.undoShow(e),this.lastDeletedTask=this.collection.get(e),u.removeTask(e)},a.prototype.undoTask=function(){return u.create(this.lastDeletedTask),this.messageClear()},a.prototype.addTask=function(t){var e,r,o,n=this;return r=t.directive,e=t.detail,t.order=$(r).find("li").length,o=u.create({target:t.directive,detail:t.detail,order:t.order},{success:function(){return n.render()}})},a.prototype.fetchStoredCollections=function(){var t,e=this;return t=this.collection.fetch(),t.done(function(){_.each(e.collection.models,function(){},e)})},a.prototype.messageClear=function(){return $(".messages").empty()},a.prototype.messageUpdate=function(e){var r,o=this;return r="<a href='#' data-id='"+e.id+"' data-action='"+e.action+"'>"+e.message+"</a>",$(".messages").empty().append(r).addClass("show"),t(6e3,function(){return o.messageClear()})},a.prototype.undoShow=function(t){var e;return e={id:t,message:"Undo",action:"undo"},this.messageUpdate(e)},a.prototype.sortablize=function(){var t=this;return $(".sortable").sortable({connectWith:".sortable",refreshPositions:!0,update:function(){return t.updateOrder()}})},a.prototype.updateOrder=function(){var t;return t={},$(".task-list").each(function(){var t;return t=$(this).find(".sortable li").each(function(t){var e,r,o,n;return n=$(this).find(".item-detail").text(),e=$(this).data("id"),o=Number(t),r=u.get(e),r.save({order:o})})})},a.prototype.searchHide=function(){return this.searchStatus=!1,$(this.taskInputWrapper).hide(),$(this.taskInput).val(""),this.clickStatus=!1},a.prototype.searchShow=function(){return this.searchStatus=!0,$(this.taskInputWrapper).show(),$(this.taskInput).focus(),this.clickStatus=!0},a.prototype.searchKeyPress=function(t){return t.keyCode===r.enter?this.searchComplete():this.searchShow()},a.prototype.searchKeyUp=function(t){return t.keyCode===r.esc&&this.searchStatus?this.searchHide():void 0},a.prototype.searchComplete=function(){var t,e;return t=$(this.taskInput).val().trim(),e=this.searchDirectives(t),this.addTask(e),this.searchHide()},a.prototype.searchDirectives=function(t){var r,o,n,a,i,s,c;o=t,i=t.split(":"),a=i[0],n=i[1],c=0;for(r in e)if(s=e[r],r===a)return c++,{directive:s,detail:n};return 0===c?{directive:"#backburner",detail:t}:void 0},a.prototype.virginCheck=function(){return 0===this.collection.size()?(u.create({target:"#day-mon",detail:"I am a task for Monday!",order:0}),this.render()):void 0},a}(Backbone.View),p=new s({collection:u}),o=function(t){function e(){return y=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.initialize=function(){},e}(Backbone.Router),c=new o})}).call(this);