(function(){var t,e,r,o={}.hasOwnProperty,n=function(t,e){function r(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};e=!0,r=function(t){return e?console.log(t):void 0},window.clearLocal=function(){return localStorage.clear()},t=function(t,e){return setTimeout(e,t)},$(function(){var e,r,o,i,a,s,c,u,p,d,l,h,y;return r={enter:13,esc:27},e={Mon:"#day-mon",mon:"#day-mon",monday:"#day-mon",Tue:"#day-tue",tue:"#day-tue",Wed:"#day-wed",wed:"#day-wed",Thur:"#day-thur",thur:"#day-thur",Fri:"#day-fri",fri:"#day-fri",od:"#onDeck",onDeck:"#onDeck",ondeck:"#onDeck",backburner:"#backburner",bb:"#backburner"},i=function(t){function e(){return d=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.defaults={target:"#backBurner",detail:"empty",order:"",complete:!1},e.prototype.initialize=function(){return this.on("remove",this.destroy)},e}(Backbone.Model),a=function(t){function e(){return l=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.url="/",e.prototype.model=i,e.prototype.localStorage=new Store("backbone-tasks"),e.prototype.removeTask=function(t,e){return this.remove(t,e)},e}(Backbone.Collection),u=new a,s=function(o){function i(){return h=i.__super__.constructor.apply(this,arguments)}var s;return n(i,o),i.prototype.el=$("body"),i.prototype.clickStatus=!1,i.prototype.lastDeletedTask="",i.prototype.taskInputWrapper=".newTask",i.prototype.taskInput="#newTaskInput",i.prototype.onDeck="#onDeck",i.prototype.onDeckList="#onDeck ul",i.prototype.today="",i.prototype.initialize=function(){return this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this),this.fetchStoredCollections(),this.virginCheck(),this.sortablize()},i.prototype.events=function(){return{keypress:"searchKeyPress",keyup:"searchKeyUp","click .delete":"deleteTask","click a[data-action=undo]":"undoTask"}},i.prototype.template_week=Handlebars.compile($("#template_week").html()),i.prototype.template_sidebar=Handlebars.compile($("#template_sidebar").html()),s=function(t,e,r){return _(t.where({target:e})).sortBy(function(t){return t.get(r)})},i.prototype.render=function(){var t,e,r,o,n,i,c,u,p,d,l,h,y,k;return c=s(this.collection,"#onDeck","order"),t=s(this.collection,"#backburner","order"),n=s(this.collection,"#day-mon","order"),l=s(this.collection,"#day-tue","order"),y=s(this.collection,"#day-wed","order"),p=s(this.collection,"#day-thur","order"),r=s(this.collection,"#day-fri","order"),u=new a(c),e=new a(t),i=new a(n),h=new a(l),k=new a(y),d=new a(p),o=new a(r),$("#sidebar").html(this.template_sidebar({onDeckTasks:u.toJSON(),backBurnerTasks:e.toJSON()})),$(".week").html(this.template_week({monTasks:i.toJSON(),tueTasks:h.toJSON(),wedTasks:k.toJSON(),thurTasks:d.toJSON(),friTasks:o.toJSON()})),this.sortablize()},i.prototype.deleteTask=function(t){var e;return e=$(t.currentTarget).closest("li").data("id"),this.undoShow(e),this.lastDeletedTask=this.collection.get(e),u.removeTask(e)},i.prototype.undoTask=function(){return u.create(this.lastDeletedTask),this.messageClear()},i.prototype.addTask=function(t){var e,r,o,n=this;return r=t.directive,e=t.detail,t.order=$(r).find("li").length,o=u.create({target:t.directive,detail:t.detail,order:t.order},{success:function(){return n.render()}})},i.prototype.fetchStoredCollections=function(){var t,e=this;return t=this.collection.fetch(),t.done(function(){_.each(e.collection.models,function(){},e)})},i.prototype.messageClear=function(){return $(".messages").empty()},i.prototype.messageUpdate=function(e){var r,o=this;return r="<a href='#' data-id='"+e.id+"' data-action='"+e.action+"'>"+e.message+"</a>",$(".messages").empty().append(r).addClass("show"),t(6e3,function(){return o.messageClear()})},i.prototype.undoShow=function(t){var e;return e={id:t,message:"Undo",action:"undo"},this.messageUpdate(e)},i.prototype.sortablize=function(){var t=this;return $(".sortable").sortable({connectWith:".sortable",refreshPositions:!0,update:function(){return t.updateOrder()}})},i.prototype.updateOrder=function(){var t;return t={},$(".task-list").each(function(){var t;return t=$(this).find(".sortable li").each(function(t){var e,r,o,n;return n=$(this).find(".item-detail").text(),e=$(this).data("id"),o=Number(t),r=u.get(e),r.save({order:o})})})},i.prototype.searchHide=function(){return this.searchStatus=!1,$(this.taskInputWrapper).hide(),$(this.taskInput).val(""),this.clickStatus=!1},i.prototype.searchShow=function(){return this.searchStatus=!0,$(this.taskInputWrapper).show(),$(this.taskInput).focus(),this.clickStatus=!0},i.prototype.searchKeyPress=function(t){return t.keyCode===r.enter?this.searchComplete():this.searchShow()},i.prototype.searchKeyUp=function(t){return t.keyCode===r.esc&&this.searchStatus?this.searchHide():void 0},i.prototype.searchComplete=function(){var t,e;return t=$(this.taskInput).val().trim(),e=this.searchDirectives(t),this.addTask(e),this.searchHide()},i.prototype.searchDirectives=function(t){var r,o,n,i,a,s,c;o=t,a=t.split(":"),i=a[0],n=a[1],c=0;for(r in e)if(s=e[r],r===i)return c++,{directive:s,detail:n};return 0===c?{directive:"#backburner",detail:t}:void 0},i.prototype.virginCheck=function(){return 0===this.collection.size()?(u.create({target:"#day-mon",detail:"I am a task for Monday!",order:0}),this.render()):void 0},i}(Backbone.View),p=new s({collection:u}),o=function(t){function e(){return y=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.initialize=function(){},e}(Backbone.Router),c=new o})}).call(this);