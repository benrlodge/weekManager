(function(){var t,e,r,o={}.hasOwnProperty,n=function(t,e){function r(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};e=!0,r=function(t){return e?console.log(t):void 0},window.clearLocal=function(){return localStorage.clear()},t=function(t,e){return setTimeout(e,t)},$(function(){var e,o,a,i,s,c,u,p,d,l,h,y,k;return o={enter:13,esc:27},e={Mon:"#day-mon",mon:"#day-mon",monday:"#day-mon",Tue:"#day-tue",tue:"#day-tue",Wed:"#day-wed",wed:"#day-wed",Thur:"#day-thur",thur:"#day-thur",Fri:"#day-fri",fri:"#day-fri",od:"#onDeck",onDeck:"#onDeck",ondeck:"#onDeck",backburner:"#backburner",bb:"#backburner"},i=function(t){function e(){return l=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.defaults={target:"#backBurner",detail:"empty",order:"",complete:!1},e.prototype.initialize=function(){return this.on("remove",this.destroy)},e}(Backbone.Model),s=function(t){function e(){return h=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.url="/",e.prototype.model=i,e.prototype.localStorage=new Store("backbone-tasks"),e.prototype.removeTask=function(t,e){return this.remove(t,e)},e}(Backbone.Collection),p=new s,c=function(a){function i(){return y=i.__super__.constructor.apply(this,arguments)}var c;return n(i,a),i.prototype.el=$("body"),i.prototype.clickStatus=!1,i.prototype.lastDeletedTask="",i.prototype.taskInputWrapper=".newTask",i.prototype.taskInput="#newTaskInput",i.prototype.onDeck="#onDeck",i.prototype.onDeckList="#onDeck ul",i.prototype.today="",i.prototype.initialize=function(){return this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this),this.fetchStoredCollections(),this.virginCheck(),this.sortablize()},i.prototype.events=function(){return{keypress:"searchKeyPress",keyup:"searchKeyUp","click .delete":"deleteTask","click a[data-action=undo]":"undoTask"}},i.prototype.template_week=Handlebars.compile($("#template_week").html()),i.prototype.template_sidebar=Handlebars.compile($("#template_sidebar").html()),c=function(t,e){var r;return r=[t.get("order"),e.get("order")],t=r[0],e=r[1],t>e?1:e>t?-1:0},i.prototype.render=function(){var t,e,r,o,n,a,i,u,p,d,l,h,y,k;return i=this.collection.where({target:"#onDeck"}).sort(c),t=this.collection.where({target:"#backburner"}).sort(c),n=this.collection.where({target:"#day-mon"}).sort(c),l=this.collection.where({target:"#day-tue"}).sort(c),y=this.collection.where({target:"#day-wed"}).sort(c),p=this.collection.where({target:"#day-thur"}).sort(c),r=this.collection.where({target:"#day-fri"}).sort(c),u=new s(i),e=new s(t),a=new s(n),h=new s(l),k=new s(y),d=new s(p),o=new s(r),$("#sidebar").html(this.template_sidebar({onDeckTasks:u.toJSON(),backBurnerTasks:e.toJSON()})),$(".week").html(this.template_week({monTasks:a.toJSON(),tueTasks:h.toJSON(),wedTasks:k.toJSON(),thurTasks:d.toJSON(),friTasks:o.toJSON()})),this.sortablize()},i.prototype.deleteTask=function(t){var e;return e=$(t.currentTarget).closest("li").data("id"),this.undoShow(e),this.lastDeletedTask=this.collection.get(e),p.removeTask(e)},i.prototype.undoTask=function(){return p.create(this.lastDeletedTask),this.messageClear()},i.prototype.addTask=function(t){var e,r,o,n=this;return r=t.directive,e=t.detail,t.order=$(r).find("li").length,o=p.create({target:t.directive,detail:t.detail,order:t.order},{success:function(){return n.render()}})},i.prototype.fetchStoredCollections=function(){var t,e=this;return t=this.collection.fetch(),t.done(function(){_.each(e.collection.models,function(){},e)})},i.prototype.messageClear=function(){return $(".messages").empty()},i.prototype.messageUpdate=function(e){var r,o=this;return r="<a href='#' data-id='"+e.id+"' data-action='"+e.action+"'>"+e.message+"</a>",$(".messages").empty().append(r).addClass("show"),t(6e3,function(){return o.messageClear()})},i.prototype.undoShow=function(t){var e;return e={id:t,message:"Undo",action:"undo"},this.messageUpdate(e)},i.prototype.sortablize=function(){var t=this;return $(".sortable").sortable({connectWith:".sortable",refreshPositions:!0,update:function(){return t.updateOrder()}})},i.prototype.updateOrder=function(){var t;return t={},$(".task-list").each(function(){var t;return t=$(this).find(".sortable li").each(function(t){var e,o,n,a,i;return i=$(this).find(".item-detail").text(),e=$(this).data("id"),n=Number(t),a="#"+$(this).closest(".task-list").attr("id"),r("targt:"),r(a),o=p.get(e),o.save({order:n,target:a})})})},i.prototype.searchHide=function(){return this.searchStatus=!1,$(this.taskInputWrapper).hide(),$(this.taskInput).val(""),this.clickStatus=!1},i.prototype.searchShow=function(){return this.searchStatus=!0,$(this.taskInputWrapper).show(),$(this.taskInput).focus(),this.clickStatus=!0},i.prototype.searchKeyPress=function(t){return t.keyCode===o.enter?this.searchComplete():this.searchShow()},i.prototype.searchKeyUp=function(t){return t.keyCode===o.esc&&this.searchStatus?this.searchHide():void 0},i.prototype.searchComplete=function(){var t,e;return t=$(this.taskInput).val().trim(),e=this.searchDirectives(t),this.addTask(e),this.searchHide()},i.prototype.searchDirectives=function(t){var r,o,n,a,i,s,c;o=t,i=t.split(":"),a=i[0],n=i[1],c=0;for(r in e)if(s=e[r],r===a)return c++,{directive:s,detail:n};return 0===c?{directive:"#backburner",detail:t}:void 0},i.prototype.virginCheck=function(){return 0===this.collection.size()?(p.create({target:"#day-mon",detail:"I am a task for Monday!",order:0}),this.render()):void 0},i}(Backbone.View),d=new c({collection:p}),a=function(t){function e(){return k=e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.initialize=function(){},e}(Backbone.Router),u=new a})}).call(this);