(function(){var t,e,o={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};t=!0,e=function(e){return t?console.log(e):void 0},$(function(){var t,o,n,i,s,c,a,p,l,u,h;return o={enter:13,esc:27},t={Mon:".mon",mon:".mon",monday:".mon",Tue:"tue",tue:".tue",Wed:".wed",wed:".wed",Thur:".thur",thur:".thur",Fri:".fri",fri:".fri",today:".today",td:".today",tomorrow:".tomorrow",tom:".tomorrow",od:".onDeck",onDeck:".onDeck",ondeck:".onDeck",backburner:".backburner",bb:".backburner"},n=function(t){function e(){return l=e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.defaults={target:".backBurner",detail:"empty",complete:!1},e.prototype.initialize=function(){return _.bindAll(this,"complete_task"),this.on("remove",this.destroy)},e.prototype.name_update=function(){var t;return t=c.get("title")},e.prototype.complete_task=function(){return this.set({complete:!0})},e}(Backbone.Model),c=new n,i=function(t){function o(){return u=o.__super__.constructor.apply(this,arguments)}return r(o,t),o.prototype.url="/",o.prototype.model=n,o.prototype.localStorage=new Store("backbone-tasks"),o.prototype.initialize=function(){return this.on("add",this.newTask,this),this.on("change",this.change,this)},o.prototype.removeTask=function(t,e){return this.remove(t,e)},o.prototype.newTask=function(t){return e("new task model: "+t.get("detail"))},o.prototype.change=function(){return e("model has been changed")},o}(Backbone.Collection),a=new i,s=function(n){function s(){return h=s.__super__.constructor.apply(this,arguments)}return r(s,n),s.prototype.el=$("body"),s.prototype.clickStatus=!1,s.prototype.taskInputWrapper=".newTask",s.prototype.taskInput="#newTaskInput",s.prototype.onDeck=".onDeck",s.prototype.onDeckList=".onDeck ul",s.prototype.today="",s.prototype.template_week=Handlebars.compile($("#template_week").html()),s.prototype.template_sidebar=Handlebars.compile($("#template_sidebar").html()),s.prototype.initialize=function(){return e("Init View"),this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this),this.getLocalCollections()},s.prototype.getLocalCollections=function(){var t,o;return o=this,t=void 0,console.log("fetching..."),t=this.collection.fetch(),t.done(function(){console.log("fetched!"),_.each(o.collection.models,function(t){e(t)},o)})},s.prototype.render=function(){var t,e,o,r,n,s,c,a,p,l,u,h,d,k;return c=this.collection.where({target:".onDeck"}),t=this.collection.where({target:".backburner"}),n=this.collection.where({target:".mon"}),u=this.collection.where({target:".tue"}),d=this.collection.where({target:".wed"}),p=this.collection.where({target:".thur"}),o=this.collection.where({target:".fri"}),a=new i(c),e=new i(t),s=new i(n),h=new i(u),k=new i(d),l=new i(p),r=new i(o),$("#sidebar").html(this.template_sidebar({onDeckTasks:a.toJSON(),backBurnerTasks:e.toJSON()})),$(".week").html(this.template_week({allTasks:this.collection.toJSON(),monTasks:s.toJSON(),tueTasks:h.toJSON(),wedTasks:k.toJSON(),thurTasks:l.toJSON(),friTasks:r.toJSON()}))},s.prototype.events=function(){return{keypress:"searchKeyPress",keyup:"searchKeyUp","click .delete":"deleteTask"}},s.prototype.deleteTask=function(t){var o,r;return e("-----------------------"),e("delete this task"),o=$(t.currentTarget),r=$(o).data("id"),e(this.collection.get(r)),e("full collection: "),e(this.collection),a.removeTask(r),e("new collection: "),e(this.collection)},s.prototype.searchHide=function(){return this.searchStatus=!1,$(this.taskInputWrapper).hide(),$(this.taskInput).val(""),this.clickStatus=!1},s.prototype.searchShow=function(){return this.searchStatus=!0,$(this.taskInputWrapper).show(),$(this.taskInput).focus(),this.clickStatus=!0},s.prototype.searchKeyPress=function(t){return t.keyCode===o.enter?this.searchComplete():this.searchShow()},s.prototype.searchKeyUp=function(t){return t.keyCode===o.esc&&this.searchStatus?this.searchHide():void 0},s.prototype.searchComplete=function(){var t;return c=$(this.taskInput).val().trim(),t=this.searchDirectives(c),this.addTask(t),this.searchHide()},s.prototype.searchDirectives=function(e){var o,r,n,i,s,c,a;r=e,s=e.split(":"),i=s[0],n=s[1],a=0;for(o in t)if(c=t[o],o===i)return a++,{directive:c,detail:n};return 0===a?{directive:".backburner",detail:e}:void 0},s.prototype.addTask=function(t){var e,o;return o=t.directive,e=t.detail,a.create({target:t.directive,detail:t.detail})},s}(Backbone.View),p=new s({collection:a})})}).call(this);